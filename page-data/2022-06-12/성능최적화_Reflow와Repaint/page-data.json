{"componentChunkName":"component---src-templates-post-template-tsx","path":"/2022-06-12/성능최적화_Reflow와Repaint/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>성능최적화, Reflow와 Repaint</h1>\n<aside>\n💡 자바스크립트 성능 최적화, reflow와 repaint\n<br/>\n<br/>\n</aside>\n<h1>📐 Reflow</h1>\n<p>HTML 요소의 크기나 위치가 변하면 영향 받는 모든 노드들의 크기와 위치를 다시 계산하게 되는데</p>\n<p>이런 요소의 변화에 따라 레이아웃 트리를 다시 생성하는 작업을 reflow라고 한다.</p>\n<p>레이아웃 계산 비용만큼 렌더링 시간도 늘어나게 된다.</p>\n<h2>Reflow를 발생시키는 경우</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">-</span>페이지 초기 렌더링\n<span class=\"token operator\">-</span>윈도우 리사이징\n<span class=\"token operator\">-</span><span class=\"token constant\">DOM</span> 노드 추가<span class=\"token operator\">/</span>제거\n<span class=\"token operator\">-</span><span class=\"token constant\">DOM</span> 노드 위치<span class=\"token punctuation\">,</span> 크기 변경\n<span class=\"token operator\">-</span>font 변경<span class=\"token punctuation\">,</span> 텍스트 내용 변경\n<span class=\"token operator\">-</span>이미지 크기 변경\n<span class=\"token operator\">-</span>애니메이션<span class=\"token punctuation\">,</span> 트랜지션 사용</code></pre></div>\n<h2>Reflow를 발생시키는 속성</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">**</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">,</span> border<span class=\"token punctuation\">,</span> display<span class=\"token punctuation\">,</span> font<span class=\"token operator\">-</span>size<span class=\"token punctuation\">,</span> vertical<span class=\"token operator\">-</span>align<span class=\"token punctuation\">,</span> text<span class=\"token operator\">-</span>align<span class=\"token punctuation\">,</span> \npadding<span class=\"token punctuation\">,</span> margin<span class=\"token punctuation\">,</span> float<span class=\"token punctuation\">,</span> position<span class=\"token operator\">**</span> 등 레이아웃에 영향을 주는 모든 속성</code></pre></div>\n<h1>🎨 Repaint</h1>\n<p>Reflow 과정이 끝나고 새로 계산된 레이아웃 트리(렌더 트리)를 다시 화면에 그리는 작업을 repaint라고 한다.</p>\n<h2>Repaint를 발생시키는 속성</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">color<span class=\"token punctuation\">,</span> visibility<span class=\"token punctuation\">,</span> border<span class=\"token operator\">-</span>radius<span class=\"token punctuation\">,</span> background<span class=\"token punctuation\">,</span> background<span class=\"token operator\">-</span>size<span class=\"token punctuation\">,</span> background<span class=\"token operator\">-</span>image<span class=\"token punctuation\">,</span> box<span class=\"token operator\">-</span>shadow<span class=\"token punctuation\">,</span> line<span class=\"token operator\">-</span>style<span class=\"token punctuation\">,</span> outline<span class=\"token operator\">...</span>\n시각적으로 보여지는 모든 속성\n레이아웃에 영향을 주지 않고<span class=\"token punctuation\">,</span> 시각적인 요소만 바뀌는 경우</code></pre></div>\n<h1>✨Reflow 최적화하기</h1>\n<p><strong>display:none의 사용</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token literal-property property\">visibility</span><span class=\"token operator\">:</span>none은 노드 공간을 차지하지만 \n<span class=\"token literal-property property\">display</span><span class=\"token operator\">:</span>none은 layout 공간을 차지하지않아 렌더 트리에서 제외된다<span class=\"token punctuation\">.</span></code></pre></div>\n<p><strong>layout과 paint를 거치지 않는 속성 사용하기</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">transfrom<span class=\"token punctuation\">,</span> opacity<span class=\"token punctuation\">,</span> cursor<span class=\"token punctuation\">,</span> orphans<span class=\"token punctuation\">,</span> perspective</code></pre></div>\n<p><strong>CSS 하위 선택자 줄이기</strong></p>\n<p>하위 선택자가 많아지면 CSSOM Tree가 깊어지고 렌더 트리를 만드는 시간이 늘어난다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// bad</span>\n<span class=\"token punctuation\">.</span>container <span class=\"token punctuation\">.</span>list li <span class=\"token punctuation\">.</span>btn <span class=\"token punctuation\">{</span>\n  background<span class=\"token operator\">-</span>color<span class=\"token operator\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// good</span>\n<span class=\"token punctuation\">.</span>list <span class=\"token punctuation\">.</span>btn <span class=\"token punctuation\">{</span>\n  background<span class=\"token operator\">-</span>color<span class=\"token operator\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>애니메이션 사용 시에는 position:fixed, absolute를 사용</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">애니메이션<span class=\"token punctuation\">,</span> 트랜지션은 reflow 연산을 발생시킨다<span class=\"token punctuation\">.</span>\n이때 position을 fixed 나 absolute를 주어 노드를 분리하여 해당 노드만 reflow 될 수 있도록 한다<span class=\"token punctuation\">.</span></code></pre></div>\n<p><strong>인라인 스타일 지양하기</strong></p>\n<p>인라인 스타일은 HTML이 파싱 될 때 레이아웃에 영향을 주어 추가적인 Reflow를 발생시킨다.</p>\n<p>물론 유지보수 및 가독성 측면에서도 인라인 스타일을 지양하는 것이 좋기도 하다.</p>\n<p><strong><table> 사용 지양하기</strong></p>\n<p>테이블은 점진적으로 렌더링 되지 않고 내부 콘텐츠가 모두 로딩된 후에 그려진다.</p>\n<p>그래서 작은 콘텐츠의 변경만 있어도 테이블의 모든 노드에 Reflow가 발생한다.</p>\n<p>만약 쓰게 된다면, table-layout: fixed를 통해 테이블의 크기를 고정하는 것도 좋은 방법이다.</p>\n<p><strong>JS를 통해 스타일변화를 주어야 할 경우, 가급적 한번에 처리한다</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// style 객체를 여러번 호출해 적용한 코드: bad 👎🏻\nconst div = document.getElementsByTagName('div');\nfor (var i = 0; i &lt; div.length; i++) {\n    div[i].style.height = '80px';\n    div[i].style.backgroundColor = '#00f';\n    div[i].style.display = 'inline-block';\n    div[i].style.overflow = 'hidden';\n    div[i].style.fontSize = '40px';\n    div[i].style.color = '#fff';\n}\n\n// css를 정의한 class명을 추가: good 👍🏻\nconst div = document.getElementsByTagName('div');\nfor (var i = 0; i &lt; div.length; i++) {\n    div[i].className = 'block'\n}</code></pre></div>\n<p><strong>will-change 속성의 사용</strong></p>\n<p><a href=\"https://wit.nts-corp.com/2017/06/05/4571\" target=\"_blank\" rel=\"nofollow\">CSS 애니메이션 성능 개선 방법(reflow 최소화, will-change 사용) | WIT블로그</a></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">will<span class=\"token operator\">-</span>change<span class=\"token operator\">:</span> auto<span class=\"token punctuation\">;</span>\nwill<span class=\"token operator\">-</span>change<span class=\"token operator\">:</span> scroll<span class=\"token operator\">-</span>position<span class=\"token punctuation\">;</span>\nwill<span class=\"token operator\">-</span>change<span class=\"token operator\">:</span> contents<span class=\"token punctuation\">;</span>\nwill<span class=\"token operator\">-</span>change<span class=\"token operator\">:</span> transform<span class=\"token punctuation\">;</span>\nwill<span class=\"token operator\">-</span>change<span class=\"token operator\">:</span> top<span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>auto\n<ul>\n<li>기본값으로 브라우저는 별다른 최적화를 실시하지 않습니다.</li>\n</ul>\n</li>\n<li>scroll-position\n<ul>\n<li>스크롤 할 때 엘리먼트의 위치가 변경될 것을 알려줍니다. 이 값을 설정하면 브라우저는 스크롤 가능한 엘리먼트를 미리 최적화 하여 랜더링 합니다. 한 번에 많은 양을 스크롤하거나 빠른 스크롤이 필요한 경우에 사용합니다.</li>\n</ul>\n</li>\n<li>contents\n<ul>\n<li>엘리먼트의 컨텐츠가 변경될 것을 알려줍니다. 브라우저는 보통 엘리먼트의 랜더링 결과를 캐싱합니다. 대부분의 엘리먼트가 변경되지 않고 변경되어도 위치가 바뀌는 정도의 미미한 변경만 발생하기 때문입니다. 하지만 엘리먼트가 계속해서 변경되는 경우 브라우저 캐시는 무의미하게 됩니다. 이 속성을 사용하게 되면 캐시를 하지 않고 변경될 때마다 처음부터 랜더링하게 됩니다.</li>\n</ul>\n</li>\n<li>\n<custom-ident>\n  - 변경하고 싶은 속성을 사용할 수 있습니다. 쉼표(,)를 이용하여 두 개 이상의 속성을 사용할 수 있습니다. 크롬에서는 현재 6가지 속성(opacity, transform, top, left, right, bottom)만 적용됩니다. [참고](https://github.com/operasoftware/devopera/pull/330).\n</li>\n</ul>\n<h3>참고</h3>\n<p>-도서: 자바스크립트 성능 최적화</p>\n<p><a href=\"https://velog.io/@soulee__/Javascript-%EB%A6%AC%ED%8E%98%EC%9D%B8%ED%8A%B8-%EB%A6%AC%ED%94%8C%EB%A1%9C%EC%9A%B0\" target=\"_blank\" rel=\"nofollow\">[Javascript] - 리페인트 &#x26; 리플로우</a></p>\n<p><a href=\"https://12bme.tistory.com/140\" target=\"_blank\" rel=\"nofollow\">[자바스크립트] 브라우저 렌더링</a></p>\n<p><a href=\"https://seokzin.tistory.com/entry/JavaScript-%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%B5%9C%EC%A0%81%ED%99%94-Reflow%EC%99%80-Repaint\" target=\"_blank\" rel=\"nofollow\">[JavaScript] 렌더링 최적화 (Reflow와 Repaint)</a></p>","frontmatter":{"title":"성능최적화, Reflow와 Repaint","summary":"자바스크립트 성능 최적화","date":"2022.06.15.","categories":["Frontend","JavaScript","HTML"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEeUlEQVQ4y1WUfWwURRjGRxqD0aCIlagBxQg0kIJAKOUf2yoRRWoILdD4icYWQhGxmtpASQCNon+VBNPEmmAx1PgRI35E0KQa/kIxgqUtvbbX69ftXu+u197OzH7M7e77mLmSKpNsJtns+5vn2fedh7muy3K5HPM8r4BzzgCwaDS61PO8w4ZhdMbj8aRpmqGUMlBKGalU6vz4+HiDZVmLdJ3jOEwpNUcpxYIgYEwIwWzbLtAgAPOTyWTrnro67+DBg2hqakJZWRn21NWhuroaVVVVqKmpQUdHBwDwdCp1AsBcXeu6boGGs2w2W5DNZvWLVZZlxQTnKC8rw72Fhf6nbW3B/vp6OtPeTmtWr6bSDSW0qrg4WLd2rf/LhQsIggCZTOYfAA9qp0KIOWxiYoIlk8nlQogp13WRtR11rX+AIrFhGjET+X00kaT+4VGakjZd+vsKffXdOVzuuhaqIFSO40ALSaVSC03TZGzevHla3V9CCAgp1dh7+2HWV5LZsJOMN3cg8dYu6N1s2IWxA9uRanwe0827ydzzNCXOfgzpB0oKAdd1f9LWtczabDYLW8qc6/uI1T5FXcsYdRcxXHuYoWsJQ88yhth6huEShqF1DMPlDH0rGBmnjpMCSFhZP8+w7UompbyoZdtSBG5IGD+6l3ofnYvB+m0YOrYP0eZajBzfi2zrG7BaD8BqexuZpgpENzAkvzlNHgCbc18zhBDfaoVJbVcKnj/NaDmMnqUMoz9+iQkCjMw00o7C/xc/fQj9axgmfz0HXSO5FXLONbBfKwxs29anUA6gZHsLuhczjLSfRDzSi+sbF6D/sXtgVi1AQj/VhUjsKMRg+d2YvvQ7PIBsIUgzhBD5Vt8ETJ87g+4lDMOnjsGcmsZQyxGMnjwE3vE++Nl3wT8/iolXlmOgohC8rwteSGRLQVLKWeCMZT5jOdP5PXpX3oJo44uId19FfGgQSdNEqNxZy6n9JeivWAhpjsP1fZJC3GR5pilCBC4B2csX6XrJnYhsW42hDxrQt6UIA0/cD2PrbbDaGvNAs2YxBrY8Apdb5Lie7u5/TZFS1lqWpYE5LyRk+7qob8NdNPDqJiSki8F3XkZk/VyYz94B+8JnIIcjvq0Q0edKyZaSXM8jIYSvGY7jVDK99GDr4ZSup+wJA5HyByiydQUZIzEY6QwS3VcQTE3k1anIHxjbfDvF9lWSl/PBOVe2LTVsZrD11UulUssF51OuUrDSKTXwTBFdL51P/TtLaLC5loyfvyb7ty9o+qMXKL2vmEYqbsVI40uhUDnl3rh6k5OTM1dPh4NlWcxXalXWsmL6g6HXnkTPSub3FLGgp4hRZG0BxTcxGtnIKFrKgr5i5hsnj0C3afpGOHiep3/fnHx8OY4zG19ciFZujHnpzh9gtDQjuvtxRMruw8DmhxB7fTuMTz5E5s+L4Okkl45zAoGajS+dODoc8wGby/kFyrFZLiQWAktt4LAHdArLSk73Xg2taCQQjmvkgPMCaACwiACWMePMU94czQjDkP0LxBFbbb+doGUAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/0cdf9e6f4438bdd01baceaf0bb33f590/83106/HTML5_oval_logo.png","srcSet":"/static/0cdf9e6f4438bdd01baceaf0bb33f590/57b01/HTML5_oval_logo.png 150w,\n/static/0cdf9e6f4438bdd01baceaf0bb33f590/17b21/HTML5_oval_logo.png 300w,\n/static/0cdf9e6f4438bdd01baceaf0bb33f590/83106/HTML5_oval_logo.png 599w","sizes":"(min-width: 599px) 599px, 100vw"},"sources":[{"srcSet":"/static/0cdf9e6f4438bdd01baceaf0bb33f590/49b8e/HTML5_oval_logo.webp 150w,\n/static/0cdf9e6f4438bdd01baceaf0bb33f590/9e34f/HTML5_oval_logo.webp 300w,\n/static/0cdf9e6f4438bdd01baceaf0bb33f590/6740c/HTML5_oval_logo.webp 599w","type":"image/webp","sizes":"(min-width: 599px) 599px, 100vw"}]},"width":599,"height":532}},"publicURL":"/static/0cdf9e6f4438bdd01baceaf0bb33f590/HTML5_oval_logo.png"}}}}]}},"pageContext":{"slug":"/2022-06-12/성능최적화_Reflow와Repaint/"}},"staticQueryHashes":[]}