{"componentChunkName":"component---src-templates-post-template-tsx","path":"/2022-06-10/리액트에서_뒤로가기_감지하기/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>리액트에서 뒤로가기 막기 history.pushState()</h1>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">history<span class=\"token punctuation\">.</span><span class=\"token function\">pushState</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>실무에서 활용한 방법: history에 state객체에 custom 값을 지정하여 담을 수 있다. 지정한 url 이동했을 때 해당 state를 꺼내서 사용 가능하다.</p>\n<h3>매개변수에 대한 설명</h3>\n<p>state: popState가 발생할 때(새로운 상태로 이동할 때=다른 페이지로 이동할 때)</p>\n<p>title: 대부분의 브라우저가 이 속성을 무시한다. 빈 문자열로 지정</p>\n<p>url: (optional), url 창에 지정한 url이 보여진다.(string)</p>\n<h2>동일 origin의 예제</h2>\n<p>| <a href=\"http://example.com/app1/index.html\" target=\"_blank\" rel=\"nofollow\">http://example.com/app1/index.html</a></p>\n<table>\n<thead>\n<tr>\n<th><a href=\"http://example.com/app2/index.html\" target=\"_blank\" rel=\"nofollow\">http://example.com/app2/index.html</a></th>\n<th>스킴(http)과 호스트(example.com) 일치</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"http://Example.com:80\" target=\"_blank\" rel=\"nofollow\">http://Example.com:80</a></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"http://example.com\" target=\"_blank\" rel=\"nofollow\">http://example.com</a></td>\n<td>HTTP의 기본 포트는 80이므로 동일한 출처</td>\n</tr>\n</tbody>\n</table>\n<h2>다른 origin의 예제</h2>\n<p>| <a href=\"http://example.com/app1\" target=\"_blank\" rel=\"nofollow\">http://example.com/app1</a></p>\n<table>\n<thead>\n<tr>\n<th><a href=\"https://example.com/app2\" target=\"_blank\" rel=\"nofollow\">https://example.com/app2</a></th>\n<th>다른 스킴</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"http://example.com\" target=\"_blank\" rel=\"nofollow\">http://example.com</a></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"http://www.example.com\" target=\"_blank\" rel=\"nofollow\">http://www.example.com</a></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"http://myapp.example.com\" target=\"_blank\" rel=\"nofollow\">http://myapp.example.com</a></td>\n<td>다른 호스트</td>\n</tr>\n<tr>\n<td><a href=\"http://example.com\" target=\"_blank\" rel=\"nofollow\">http://example.com</a></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"http://example.com:8080\" target=\"_blank\" rel=\"nofollow\">http://example.com:8080</a></td>\n<td>다른 포트</td>\n</tr>\n</tbody>\n</table>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/API/History/pushState\" target=\"_blank\" rel=\"nofollow\">History.pushState() - Web API | MDN</a></p>\n<h2>리액트 프로젝트에서 사용하기</h2>\n<p>리스트에서 상세페이지로 넘어갔다가 다시 뒤로가기를 클릭하여 이동할 때 기존의 검색 state 값을 유지해야했다.</p>\n<p><strong>해결방식</strong></p>\n<ol>\n<li>리스트에서 상세페이지로 이동할 때 useNavigation을 이용하여 state를 담아 보낸다.</li>\n<li>상세페이지에서 뒤로가기 버튼을 눌렀을 때 이를 감지하여 받아온 state를 다시 담아 보낸다.</li>\n</ol>\n<p><strong>리스트에서 상세로 링크 이동한다.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> navigate <span class=\"token operator\">=</span> <span class=\"token function\">useNavigate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">&lt;</span>RadiusButton\n\tonClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t  <span class=\"token function\">navigate</span><span class=\"token punctuation\">(</span>\n\t    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/carsale/seller-order-detail/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">BOOKING_CD</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n\t    <span class=\"token punctuation\">{</span>\n\t      <span class=\"token literal-property property\">state</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t        <span class=\"token literal-property property\">detailSearchForm</span><span class=\"token operator\">:</span> searchForm<span class=\"token punctuation\">,</span>\n\t      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\t<span class=\"token operator\">></span>\n\t상세보기\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">RadiusButton</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><strong>상세화면에서 뒤로가기 클릭을 감지한다.</strong></p>\n<p>리스트에서 받아온 state 값을 useLocation을 이용하여 꺼낸다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> <span class=\"token function\">useLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">preventGoBack</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">const</span> detailSearchForm <span class=\"token operator\">=</span> location<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span> \n\t      window<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">.</span><span class=\"token function\">pushState</span><span class=\"token punctuation\">(</span>\n\t\t\t\t\tdetailSearchForm<span class=\"token punctuation\">,</span>\n\t\t\t\t\t<span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t<span class=\"token string\">'/carsale/seller-order-list'</span>\n\t\t\t\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'popstate'</span><span class=\"token punctuation\">,</span> preventGoBack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'popstate'</span><span class=\"token punctuation\">,</span> preventGoBack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"https://velog.io/@rkd028/React-Javascript-%EB%92%A4%EB%A1%9C%EA%B0%80%EA%B8%B0-%EB%A7%89%EA%B8%B0\" target=\"_blank\" rel=\"nofollow\">[React + Javascript] 뒤로가기 막기(이벤트 최소화)</a></p>\n<p><a href=\"https://9x211x2.tistory.com/22\" target=\"_blank\" rel=\"nofollow\">[React] navigate로 컴포넌트 이동시 props 전달 방법</a></p>","frontmatter":{"title":"리액트에서 history.pushState() 사용하여 뒤로가기 막기","summary":"history.pushState() 사용하여 뒤로가기 버튼 클릭을 감지한다. 실무에서 활용한 방법: history에 state객체에 custom 값을 지정하여 담을 수 있다.","date":"2022.06.10.","categories":["JavaScript","React"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz2NQwgWUlZWUlZVVVEAMJWWsShhw6VVUkFeQk1WUk1WQk1VSUCBas7KyooKChrGZgU+IhrGZoW+ouoGxIki/MlGaFWSkDXyCTcIT3LrmmkYk6bn5yEtLgt2PXzPIWnlNcyvLtGLnxkk2+TVOjZMsUgo0TMxBlqPqx6ZZXs7QL8w0KsWpcZJjba9jbZ9pVIqBd7CinBwhzTAjzBOybfJqHKq6bQvqzKJTlRQViA0wBTlZHQdX45AYq8xS45A4LWt7BVkZIvwMjShFFXUNTVMLBWkpTTNLZTV1JUVFUuJZUVFBTlZZWUVRVharTnyaQbGqrAJNajgAAIe0an5q22AbAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/cba0b89d2bf2d96a1ed26edb5849f804/07887/react-logo.png","srcSet":"/static/cba0b89d2bf2d96a1ed26edb5849f804/387ef/react-logo.png 300w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/22925/react-logo.png 600w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/07887/react-logo.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/cba0b89d2bf2d96a1ed26edb5849f804/2fedb/react-logo.webp 300w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/4fcbd/react-logo.webp 600w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/0d4d1/react-logo.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":630}},"publicURL":"/static/cba0b89d2bf2d96a1ed26edb5849f804/react-logo.png"}}}}]}},"pageContext":{"slug":"/2022-06-10/리액트에서_뒤로가기_감지하기/"}},"staticQueryHashes":[]}